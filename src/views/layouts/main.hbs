<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{{title}} :: Online Auction Management System Using Algorithmic Game Theory</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <!-- SweetAlert2 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/limonte-sweetalert2/7.2.0/sweetalert2.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/limonte-sweetalert2/7.2.0/sweetalert2.all.min.js"></script>
    <link href="/styles.css" rel="stylesheet" />
</head>

<body class="bg-gray-100">
    <div class="min-h-screen bg-gray-50 lg:px-60">
        <!-- Top Navbar -->
        <header class="px-4 py-3 bg-white shadow md:px-6">
            <div class="flex items-center justify-between">
                <!-- Logo + Title -->
                <div class="flex items-center space-x-2">
                    <div class="h-8 w-8 bg-gradient-to-r from-purple-500 to-blue-500 rounded"></div>
                    <span class="font-semibold text-base sm:text-lg">Auctioning System</span>
                </div>

                <!-- Desktop Nav -->
                <nav class="hidden md:flex items-center space-x-6 text-gray-600">
                    <a href="/" class="hover:text-black {{#if isDashboard}}text-blue-500{{/if}}">Dashboard</a>
                    <a href="/auctions" class="hover:text-black {{#if isAutions}}text-blue-500{{/if}}">Auctions</a>
                    <a href="/bids" class="hover:text-black {{#if isBids}}text-blue-500{{/if}}">Bids</a>
                    <a href="/bids/result" class="hover:text-black {{#if isResult}}text-blue-500{{/if}}">Result</a>
                </nav>

                <!-- Right Actions -->
                <div class="flex items-center space-x-3 sm:space-x-4">
                    <button class="h-8 w-8 rounded-full bg-gray-200 flex items-center justify-center">
                        <span class="fa fa-bell text-sm sm:text-base"></span>
                    </button>
                    <!-- User Dropdown -->
                    <div class="relative">
                        <!-- Avatar button -->
                        <button id="user-menu-btn"
                            class="h-8 w-8 rounded-full bg-gray-400 flex justify-center items-center focus:outline-none">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-white" viewBox="0 0 24 24"
                                fill="none">
                                <g clip-path="url(#clip0)">
                                    <path
                                        d="M12 12C14.8 12 17 9.8 17 7C17 4.2 14.8 2 12 2C9.2 2 7 4.2 7 7C7 9.8 9.2 12 12 12Z"
                                        stroke="currentColor" stroke-width="1.5" stroke-linecap="round"
                                        stroke-linejoin="round" />
                                    <path d="M20.6 22C20.6 18.1 16.7 15 12 15C7.3 15 3.4 18.1 3.4 22"
                                        stroke="currentColor" stroke-width="1.5" stroke-linecap="round"
                                        stroke-linejoin="round" />
                                </g>
                                <defs>
                                    <clipPath id="clip0">
                                        <rect width="24" height="24" />
                                    </clipPath>
                                </defs>
                            </svg>
                        </button>

                        <!-- Dropdown menu -->
                        <div id="user-menu"
                            class="absolute right-0 mt-2 w-40 bg-white rounded-lg shadow-lg py-2 hidden md:group-hover:block z-50">
                            <a href="/profile" class="block px-4 py-2 text-gray-700 hover:bg-gray-100">Profile</a>
                            <a href="/settings" class="block px-4 py-2 text-gray-700 hover:bg-gray-100">Settings</a>
                            <form method="POST" action="/logout">
                                <button type="submit"
                                    class="w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100">Logout</button>
                            </form>
                        </div>
                    </div>


                    <!-- Mobile Hamburger -->
                    <button id="menu-btn" class="md:hidden text-gray-600 focus:outline-none">
                        <i class="fa fa-bars text-lg"></i>
                    </button>
                </div>
            </div>

            <!-- Mobile Drawer Menu -->
            <div id="mobile-menu"
                class="fixed inset-y-0 left-0 w-64 bg-white shadow-lg transform -translate-x-full transition-transform duration-300 ease-in-out z-50 md:hidden">
                <div class="p-4 flex justify-between items-center border-b">
                    <span class="font-semibold">Menu</span>
                    <button id="close-menu" class="text-gray-600">
                        <i class="fa fa-times"></i>
                    </button>
                </div>
                <nav class="flex flex-col p-4 space-y-3 text-gray-700">
                    <a href="/" class="hover:text-black {{#if isDashboard}}text-blue-500{{/if}}">Dashboard</a>
                    <a href="/auctions" class="hover:text-black {{#if isAutions}}text-blue-500{{/if}}">Auctions</a>
                    <a href="/bids" class="hover:text-black {{#if isBids}}text-blue-500{{/if}}">Bids</a>
                    <a href="/bids/result" class="hover:text-black {{#if isResult}}text-blue-500{{/if}}">Result</a>
                </nav>
            </div>

            <!-- Overlay -->
            <div id="overlay" class="hidden fixed inset-0 bg-black bg-opacity-40 z-40 md:hidden"></div>

        </header>

        <main class="mt-6">
            {{{ body }}}
        </main>
    </div>
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    <script>
        const menuBtn = document.getElementById("menu-btn");
        const closeBtn = document.getElementById("close-menu");
        const mobileMenu = document.getElementById("mobile-menu");
        const overlay = document.getElementById("overlay");

        menuBtn?.addEventListener("click", () => {
            mobileMenu.classList.remove("-translate-x-full");
            overlay.classList.remove("hidden");
        });

        closeBtn?.addEventListener("click", () => {
            mobileMenu.classList.add("-translate-x-full");
            overlay.classList.add("hidden");
        });

        overlay?.addEventListener("click", () => {
            mobileMenu.classList.add("-translate-x-full");
            overlay.classList.add("hidden");
        });


        const userBtn = document.getElementById("user-menu-btn");
        const userMenu = document.getElementById("user-menu");

        userBtn?.addEventListener("click", (e) => {
            e.stopPropagation();
            userMenu.classList.toggle("hidden");
        });

        // Close dropdown if clicked outside
        document.addEventListener("click", (e) => {
            if (!userMenu.contains(e.target) && !userBtn.contains(e.target)) {
                userMenu.classList.add("hidden");
            }
        });
        window.socket = io({
            auth: {
                user: {{{ json user }}}
                }
            });

        socket.on('connect', () => {
            console.log('Connected to socket server:', socket.id);
        });
        window.socket.on("you-win", (data) => {
            swal(
                'Congratulations',
                `Cheer ${data.name} <b style="color:green;">You Won</b> the bid!`,
                'success'
            )
        });
    </script>
</body>

</html>